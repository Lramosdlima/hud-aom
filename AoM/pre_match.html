<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <style>
    body {
      margin: 0;
      font-family: 'Transcend', sans-serif;
    }

    .hud {
      width: 1920px;
      height: 1080px;
      position: relative;
    }

    .layout {
      background: no-repeat center;
      background-size: cover;
      width: 100%;
      height: 100%;
      position: absolute;
      filter: brightness(70%);
    }

    .campo-placar {
      position: absolute;
      color: #e8caa6;
      font-size: 90px;
      font-weight: bold;
      top: 100px;
      z-index: 12;
      -webkit-text-stroke-width: 0.5px;
      -webkit-text-stroke-color: rgb(83, 59, 23);
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
    }

    #placar-1 {
      left: 830px;

    }

    #placar-2 {
      right: 834px;
    }

    #placar-border {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translate(-50%, 0%);
      width: 445px;
      height: auto;
      z-index: 10;
    }

    .campo-nome {
      color: #ecc884;
      font-weight: bold;
      position: absolute;
      padding: 1px 2px;
      border-radius: 8px;
      position: absolute;
      top: 90px;
      font-size: 50px;
      white-space: nowrap;
      font-family: 'Transcend', Arial, sans-serif;
      -webkit-text-stroke-width: 1px;
      -webkit-text-stroke-color: rgb(178, 136, 72);
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
    }

    #jogador-1 {
      right: 1200px;
    }

    #jogador-2 {
      left: 1200px;
    }

    .bandeira {
      width: 45px;
      height: auto;
      position: absolute;
      top: 72px;
      transform: translateY(-50%);
      border-radius: 8px;
      z-index: 12;
      border: 2px solid #2e2208;
    }

    #bandeira-1 {
      left: 41.3%;
    }

    #bandeira-2 {
      right: 41.3%;
    }

    .avatar {
      width: 180px;
      height: auto;
      position: absolute;
      top: 164px;
      border-radius: 50%;
      border: 3px solid #2e2208;
      z-index: 10;
    }

    #avatar-1 {
      left: 322px;
    }

    #avatar-2 {
      right: 322px;
    }

    .avatar-border {
      width: 220px;
      height: auto;
      position: absolute;
      top: 150px;
      z-index: 10;
    }

    #avatar-border-1 {
      left: 305px;
    }

    #avatar-border-2 {
      right: 305px;
    }

    .god-border {
      width: 500px;
      height: auto;
      position: absolute;
      top: 300px;
      z-index: 5;
      opacity: 0.7;
    }

    #god-border-1 {
      left: 285px;
    }

    #god-border-2 {
      right: 285px;
    }

    #fase {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      color: #ecc884;
      font-weight: bold;
      font-size: 35px;
      font-family: sans-serif;
      z-index: 5;
      -webkit-text-stroke-width: 0.5px;
      -webkit-text-stroke-color: rgb(178, 136, 72);
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      background: linear-gradient(to top, rgba(70, 53, 28, 0.7) 1%, transparent 100%);
      padding: 6px 8px;
      border-radius: 6px;
    }

    #logo-campeonato {
      position: absolute;
      top: 30%;
      left: 50%;
      transform: translate(-50%, 0%);
      width: 650px;
      height: auto;
      z-index: 10;
    }

    #proxima-partida {
      position: absolute;
      top: 40px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 22px;
      color: rgb(252, 252, 252);
      font-weight: bold;
      z-index: 5;
    }

    #imagem-mapa {
      position: absolute;
      bottom: 58px;
      left: 734px;
      width: 413px;
      height: auto;
      z-index: 10;
    }

    #mapa-border {
      position: absolute;
      bottom: 58px;
      left: 730px;
      width: 430px;
      height: auto;
      z-index: 10;
    }

    .deus {
      width: 500px;
      height: auto;
      position: absolute;
      top: 300px;
      z-index: 5;
    }

    #god-1 {
      left: 285px;
    }

    #god-2 {
      right: 285px;
    }

    #nome-mapa {
      display: none;
    }

    .pick-ban-row {
      position: absolute;
      display: flex;
      gap: 10px;
      transform: translateX(-50%);
    }

    #gods-1 {
      top: 867.5px;
      left: 24.3%;
    }

    #maps-1 {
      top: 967px;
      left: 24.3%;
    }

    #gods-2 {
      top: 867.5px;
      left: 75.5%;
    }

    #maps-2 {
      top: 967px;
      left: 75.5%;
    }

    .pick-ban-row img {
      width: 78px;
      height: auto;
    }

    .pick-ban-row.reverse {
      flex-direction: row-reverse;
    }

    .resultados-partidas {
      position: absolute;
      left: 50%;
      bottom: 42.8%;
      transform: translate(-50%, 50%);
      display: flex;
      flex-direction: column;
      gap: 15px;
      font-family: sans-serif;
      font-weight: lighter;
      color: rgb(255, 255, 255);
      font-size: 20px;
    }

    .partida {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .deus-img {
      width: 55px;
      height: auto;
      object-fit: contain;
    }

    .mapa-img {
      width: 55px;
      height: auto;
      object-fit: contain;
    }

    .cinza {
      filter: grayscale(90%);
    }

    .nome {
      margin-right: 2px;
    }

    .partida.esquerda {
      padding: 2px 5px;
      border-radius: 6px;
      background: linear-gradient(to right, rgba(25, 25, 85, 0.7) 1%, transparent 100%);
    }

    .partida.direita {
      justify-content: flex-end;
      padding: 2px 4px;
      border-radius: 6px;
      background: linear-gradient(to left, rgba(116, 23, 23, 0.7) 1%, transparent 100%);
    }
  </style>
</head>

<body>
  <div class="hud">

    <div class="layout" id="layout"></div>
  </div>

  <div id="fase"></div>
  <div class="campo-placar" id="placar-1">0</div>
  <div class="campo-placar" id="placar-2">0</div>
  <div class="campo-nome" id="jogador-1"></div>
  <div class="campo-nome" id="jogador-2"></div>
  <img id="avatar-1" class="avatar" src="" alt="Avatar Azul" onerror="this.src='assets/campeonatos/sem_avatar.png'">
  <img id="avatar-2" class="avatar" src="" alt="Avatar Vermelha"  onerror="this.src='assets/campeonatos/sem_avatar.png'">
  <img id="avatar-border-1" class="avatar-border" src="assets/moldura_azul.png" alt="Borda Azul">
  <img id="avatar-border-2" class="avatar-border" src="assets/moldura_vermelho.png" alt="Borda Vermelha">
  <img id="bandeira-1" class="bandeira" src="" alt="Bandeira Azul" onerror="this.src='assets/null.png'">
  <img id="bandeira-2" class="bandeira" src="" alt="Bandeira Vermelha" onerror="this.src='assets/null.png'">
  <img id="logo-campeonato" src="" alt="Logo Campeonato">
  <img id="placar-border" src="assets/draft/placar.png" alt="Borda Placar">
  <!-- <div id="proxima-partida">Próxima partida</div> -->
  <img id="imagem-mapa" src="" alt="Imagem do Mapa" onerror="this.src='assets/null.png'">
  <img id="mapa-border" src="assets/mapas-3d/base.png" alt="Borda Mapa">
  <img id="god-1" class="deus" src="" alt="Deus 1">
  <img id="god-2" class="deus" src="" alt="Deus 2">
  <img id="god-border-1" class="god-border" src="assets/draft/moldura_god.png" alt="Borda Deus 1">
  <img id="god-border-2" class="god-border" src="assets/draft/moldura_god.png" alt="Borda Deus 2">
  <!-- <div id="nome-mapa"></div> -->
  <!-- <div class="resultados-partidas" id="resultados-partidas"></div> -->

  <!-- Picks & Bans gods e maps -->
  <!-- <div id="gods-1" class="pick-ban-row reverse"></div>
  <div id="gods-2" class="pick-ban-row"></div> -->
  <!-- <div id="maps-1" class="pick-ban-row reverse"></div>
  <div id="maps-2" class="pick-ban-row"></div> -->
  </div>

  <script>
    const gerarNomeArquivo = (nome) => {
      // Remove espaços e acentos
      return nome
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, '')
        .replace(/\s+/g, '')
        .toLowerCase();
    };

    function capitalize(nome) {
      if (!nome) return '';
      return nome.charAt(0).toUpperCase() + nome.slice(1);
    }

    async function atualizarCampos() {
      try {
        const response = await fetch('dados.txt?_=' + new Date().getTime());
        const texto = await response.text();
        const linhas = texto.split('\n');

        let dados = {};
        linhas.forEach(linha => {
          const linhaLimpa = linha.trim();
          if (!linhaLimpa || linhaLimpa.startsWith('#')) return;
          const [chave, valor] = linhaLimpa.split('=');
          if (chave && valor) dados[chave.trim()] = valor.trim();
        });

        const interface = dados.interface || '1';

        document.getElementById('layout').style.backgroundImage = `url('assets/draft/composicao_${interface}.gif')`;

        const getBandeira = (pais) => pais ? `assets/bandeiras/${pais.toLowerCase()}.png` : '';

        document.getElementById('placar-1').textContent = dados.placar_1 || '0';
        document.getElementById('placar-2').textContent = dados.placar_2 || '0';
        document.getElementById('jogador-1').textContent = dados.jogador_1 || '';
        document.getElementById('jogador-2').textContent = dados.jogador_2 || '';

        document.getElementById('avatar-1').src = dados.avatar_1 || 'assets/campeonatos/sem_avatar.png';
        document.getElementById('avatar-2').src = dados.avatar_2 || 'assets/campeonatos/sem_avatar.png';
        document.getElementById('bandeira-1').src = getBandeira(dados.pais_1);
        document.getElementById('bandeira-2').src = getBandeira(dados.pais_2);
        // document.getElementById('fase').textContent = dados.fase || '';
        document.getElementById('logo-campeonato').src = dados.logo_camp ? `assets/campeonatos/${dados.logo_camp}.png` : '';

        const nomeMapa = dados.mapa || '';

        document.getElementById('fase').textContent = capitalize(nomeMapa) || '';
        // document.getElementById('nome-mapa').textContent = nomeMapa;
        document.getElementById('imagem-mapa').src = nomeMapa
          ? `assets/mapas-3d/${gerarNomeArquivo(nomeMapa)}.png`
          : '';

        const gods = (dados.gods || '').split(',');
        const lowerCase = (str) => str.toLowerCase();
        document.getElementById('god-1').src = gods[0] ? `assets/draft/gods/${lowerCase(gods[0])}.jpg` : '';
        document.getElementById('god-2').src = gods[1] ? `assets/draft/gods/${lowerCase(gods[1])}.jpg` : '';

        // const maps = (dados.gods || '').split(',');
        // document.getElementById('maps-1').src = gods[0] ? `mapas/${maps[0].toLowerCase()}.png` : '';
        // document.getElementById('maps-2').src = gods[1] ? `mapas/${maps[1].toLowerCase()}.png` : '';

        // const atualizarListaImagens = (id, lista) => {
        //   const container = document.getElementById(id);
        //   container.innerHTML = '';
        //   const isMap = id.includes('maps'); // detecta se é mapa
        //   const pasta = isMap ? 'mapas' : 'gods';

        //   lista.forEach(nome => {
        //     const img = document.createElement('img');
        //     img.src = `${pasta}/${gerarNomeArquivo(nome)}.png`;
        //     container.appendChild(img);
        //   });
        // };

        // atualizarListaImagens('gods-1', (dados.gods_1 || '').split(',').filter(x => x));
        // atualizarListaImagens('gods-2', (dados.gods_2 || '').split(',').filter(x => x));
        // atualizarListaImagens('maps-1', (dados.maps_1 || '').split(',').filter(x => x));
        // atualizarListaImagens('maps-2', (dados.maps_2 || '').split(',').filter(x => x));

        async function carregarDados() {
          try {
            const response = await fetch('dados.txt?_=' + new Date().getTime());
            const texto = await response.text();
            const linhas = texto.split('\n');
            const dados = {};

            linhas.forEach(linha => {
              const [chave, valor] = linha.split('=');
              if (chave && valor !== undefined) {
                dados[chave.trim()] = valor.trim();
              }
            });

            // exibirPartidas(dados);
          } catch (err) {
            console.error('Erro ao carregar dados.txt:', err);
          }
        }

        // function exibirPartidas(dados) {
        //   const container = document.getElementById('resultados-partidas');
        //   container.innerHTML = '';

        //   let partidas = [];
        //   for (let i = 1; i <= 99; i++) {
        //     const key = `partida${i}`;
        //     if (dados[key]) partidas.push(dados[key]);
        //   }

        //   if (partidas.length > 6) {
        //     partidas = partidas.slice(-6);
        //   }

        //   partidas.forEach(linha => {
        //     const valores = linha.split(',');
        //     if (valores.length < 4) return;

        //     const [vencInfo, perdDeus, mapa, vencedorValor] = valores.map(s => s.trim());
        //     if (!vencInfo || !perdDeus || !mapa || !vencedorValor) return;

        //     // Remove o número da partida (antes do nome)
        //     const vencInfoLimpo = vencInfo.replace(/^\d+\.\s*/, '');
        //     const [vencNome, vencDeus] = vencInfoLimpo.split(':');
        //     if (!vencNome || !vencDeus) return;

        //     const partidaDiv = document.createElement('div');
        //     partidaDiv.className = 'partida';

        //     if (vencedorValor === "B") {
        //       partidaDiv.classList.add("direita");
        //     } else {
        //       partidaDiv.classList.add("esquerda");
        //     }

        //     const nomeSpan = document.createElement('span');
        //     nomeSpan.className = 'nome';
        //     nomeSpan.textContent = vencNome;

        //     const imgVencedor = document.createElement('img');
        //     imgVencedor.className = 'deus-img';
        //     imgVencedor.src = `gods/${vencDeus.toLowerCase()}.png`;

        //     const imgMapa = document.createElement('img');
        //     imgMapa.className = 'mapa-img';
        //     imgMapa.src = `mapas/${mapa.toLowerCase().replace(/\s+/g, '')}.png`;

        //     const imgPerdedor = document.createElement('img');
        //     imgPerdedor.className = 'deus-img cinza';
        //     imgPerdedor.src = `gods/${perdDeus.toLowerCase()}.png`;

        //     if (vencedorValor === "B") {
        //       partidaDiv.appendChild(imgPerdedor);
        //       partidaDiv.appendChild(imgMapa);
        //       partidaDiv.appendChild(imgVencedor);
        //       partidaDiv.appendChild(nomeSpan);
        //     } else {
        //       partidaDiv.appendChild(nomeSpan);
        //       partidaDiv.appendChild(imgVencedor);
        //       partidaDiv.appendChild(imgMapa);
        //       partidaDiv.appendChild(imgPerdedor);
        //     }

        //     container.appendChild(partidaDiv);
        //   });
        // }

        carregarDados();
      } catch (error) {
        console.error("Erro ao carregar dados:", error);
      }
    }

    atualizarCampos();
    setInterval(atualizarCampos, 2000);
  </script>
</body>

</html>